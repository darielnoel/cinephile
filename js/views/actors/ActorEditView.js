define(["jquery","jquerySerialize","underscore","backbone","models/actor/ActorModel","text!templates/actors/actorEditTemplate.html"],function(a,b,c,d,e,f){var g=d.View.extend({el:a("#actor-edit"),events:{"submit .actors-edit-form":"saveItem","click .delete":"deleteItem","click .cancel":"cancelItem"},model:{},initialize:function(a){var b=this;b.moviesCollection=a.moviesCollection,b.actorsCollection=a.actorsCollection,b.router=a.router},render:function(b){var d,g,h=this,i=b.id,j=h.$el;h.actorsCollection.fetch(),i?(g=h.actorsCollection.get(i),h.model=g,h.model.fetch({success:function(a){var b=c.template(f,{data:a});j.html(b)}})):(g=new e,h.model=g,d=c.template(f,{data:g}),j.html(d)),j.find("#files").change(a.proxy(h.handleFileSelect,h)),h.show()},handleFileSelect:function(a){for(var b,c=this,d=c.$el,e=a.target.files,f=0;b=e[f];f++)if(b.type.match("image.*")){var g=new FileReader;g.onload=function(){return function(a){d.find("#store-image img").attr("src",a.target.result),c.model.set("image",a.target.result)}}(b),g.readAsDataURL(b)}},saveItem:function(b){var c=this,d=a(b.currentTarget).serializeObject();return d.cid&&c.actorsCollection.add(c.model),c.model.save(d,{success:function(){c.router.navigate("actors",{trigger:!0})}}),!1},cancelItem:function(){this.router.navigate("actors",{trigger:!0})},deleteItem:function(){var a=this;a.model.destroy({success:function(){a.router.navigate("actors",{trigger:!0})}})},hide:function(){this.$el.hide()},show:function(){this.$el.show()}});return g});